(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ca7ac25a"],{"0c01":function(e,t,n){"use strict";n.r(t);var c=n("7a23"),r={class:"structure"},o={class:"title"},a={class:"search"},i=["placeholder"],s={key:0,class:"items-header"},l={key:1,class:"items-header"};function u(e,t,n,u,d,p){var h=Object(c["resolveComponent"])("AccountControlCard"),f=Object(c["resolveComponent"])("Modal");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",r,[Object(c["createElementVNode"])("p",o,Object(c["toDisplayString"])(e.$localizeFilter("accounts_in_control")),1),Object(c["createElementVNode"])("div",a,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=function(e){return d.searchString=e}),class:"custom-input",placeholder:e.$localizeFilter("placeholder_login_or_partner_name")},null,8,i),[[c["vModelText"],d.searchString,void 0,{trim:!0}]]),Object(c["createElementVNode"])("button",{class:"blue-button",onClick:t[1]||(t[1]=function(){return p.startSearch&&p.startSearch.apply(p,arguments)})},Object(c["toDisplayString"])(e.$localizeFilter("search_button")),1)]),d.requests.length?(Object(c["openBlock"])(),Object(c["createElementBlock"])("p",s,"Заявки: "+Object(c["toDisplayString"])(d.requests.length),1)):Object(c["createCommentVNode"])("",!0),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(d.requests,(function(e,t){return Object(c["openBlock"])(),Object(c["createBlock"])(h,{key:t,account:e,isRequest:!0,onOpenClientDetails:p.openClientDetails,onGetControl:function(t){return p.getControl(e.requestId)},onRefuseControl:function(t){return p.refuseControl(e.requestId)}},null,8,["account","onOpenClientDetails","onGetControl","onRefuseControl"])})),128)),d.managedAccounts.length?(Object(c["openBlock"])(),Object(c["createElementBlock"])("p",l,"Аккаунты в управлении: "+Object(c["toDisplayString"])(p.visibleManagedAccounts.length),1)):Object(c["createCommentVNode"])("",!0),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(p.visibleManagedAccounts,(function(e,t){return Object(c["openBlock"])(),Object(c["createBlock"])(h,{key:t,account:e,onOpenClientDetails:p.openClientDetails,onGoToAccount:function(t){return p.goToAccount(e.clientId,e.nickname)},onCancelControl:function(t){return p.cancelControl(e.clientId)}},null,8,["account","onOpenClientDetails","onGoToAccount","onCancelControl"])})),128)),d.showModal?(Object(c["openBlock"])(),Object(c["createBlock"])(f,{key:2,type:"clientDetails",actionType:"openClientDetails",clientId:d.openClientId,onCloseModal:p.closeModal},null,8,["clientId","onCloseModal"])):Object(c["createCommentVNode"])("",!0)])}var d=n("1da1"),p=(n("96cf"),n("ac1f"),n("841c"),n("2ca0"),n("5319"),n("e977")),h={class:"info"},f={class:"title"},b={class:"actions"};function m(e,t,n,r,o,a){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{class:Object(c["normalizeClass"])(["card",e.isRequest?"request":""])},[Object(c["createElementVNode"])("div",h,[Object(c["createElementVNode"])("div",f,Object(c["toDisplayString"])(e.account.nickname),1),Object(c["createElementVNode"])("div",{class:"right info-icon",onClick:t[0]||(t[0]=Object(c["withModifiers"])((function(t){return e.clientDetailsClick(e.account.clientId)}),["stop"]))})]),Object(c["createElementVNode"])("div",b,[e.isRequest?(Object(c["openBlock"])(),Object(c["createElementBlock"])("button",{key:0,class:"blue-button",onClick:t[1]||(t[1]=function(t){return e.getControl()})},Object(c["toDisplayString"])(e.$localizeFilter("Взять управление")),1)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("button",{key:1,class:"blue-button",onClick:t[2]||(t[2]=function(t){return e.goToAccount()})},Object(c["toDisplayString"])(e.$localizeFilter("Перейти в аккаунт")),1)),Object(c["createElementVNode"])("button",{class:Object(c["normalizeClass"])(["blue-button red",e.isRequest?"":"link"]),onClick:t[3]||(t[3]=function(t){return e.isRequest?e.refuseControl():e.cancelControl()})},Object(c["toDisplayString"])(e.$localizeFilter("Отказаться от управления")),3)])],2)}var g=n("a6f4"),O=Object(g["a"])({setup:function(){},data:function(){return{}},props:["account","isRequest"],methods:{clientDetailsClick:function(e){this.$emit("openClientDetails",e)},getControl:function(){this.$emit("getControl")},refuseControl:function(){this.$emit("refuseControl")},goToAccount:function(){this.$emit("goToAccount")},cancelControl:function(){this.$emit("cancelControl")}}}),j=(n("a3ac"),n("d959")),C=n.n(j);const v=C()(O,[["render",m],["__scopeId","data-v-22496d92"]]);var k=v,w=n("2930"),x={components:{AccountControlCard:k,Modal:w["a"]},data:function(){return{requests:[],managedAccounts:[],openClientId:null,showModal:!1,searchString:"",search:null}},watch:{searchString:function(e,t){var n=this;""===e&&this.$nextTick((function(){n.search=null,n.$forceUpdate()}))}},computed:{visibleManagedAccounts:function(){console.log("force update");var e=JSON.parse(JSON.stringify(this.managedAccounts));if(null==this.search)return e;for(var t=[],n=0;n<e.length;n++)if((e[n].nickname||"").startsWith(this.search))t.push(e[n]);else{var c=e[n].firstName+" "+e[n].lastName;c.startsWith(this.search)&&t.push(e[n])}return t}},methods:{startSearch:function(){var e=this;""!==this.searchString&&(this.search=this.searchString.replace("@","")),this.$nextTick((function(){e.$forceUpdate()}))},closeModal:function(){this.showModal=!1},openClientDetails:function(e){this.openClientId=e,this.showModal=!0},loadData:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var n,c,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("getManagedClientsAndRequestsByManager");case 2:n=t.sent,c=n.requests,r=n.clients,e.requests=c,e.managedAccounts=r;case 7:case"end":return t.stop()}}),t)})))()},getControl:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$store.dispatch("confirmManagementRequest",{requestId:e});case 3:return t.$message(Object(p["a"])("profile_updated")),n.next=6,t.loadData();case 6:n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),t.$error(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},refuseControl:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$store.dispatch("refuseManagementRequest",{requestId:e});case 3:return t.$message(Object(p["a"])("profile_updated")),n.next=6,t.loadData();case 6:n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),t.$error(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},cancelControl:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$store.dispatch("cancelManagementByManager",{managedClientId:e});case 3:return t.$message(Object(p["a"])("profile_updated")),n.next=6,t.loadData();case 6:n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),t.$error(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},goToAccount:function(e,t){var n=this;return Object(d["a"])(regeneratorRuntime.mark((function c(){return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:n.$emit("startManaging",e,t);case 1:case"end":return c.stop()}}),c)})))()}},mounted:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$emit("mountedChild","Structure"),t.prev=1,t.next=4,e.loadData();case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](1),e.$error(t.t0);case 9:case"end":return t.stop()}}),t,null,[[1,6]])})))()}};n("90b4");const $=C()(x,[["render",u],["__scopeId","data-v-d883779c"]]);t["default"]=$},"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"43e5":function(e,t,n){},"760b":function(e,t,n){},"841c":function(e,t,n){"use strict";var c=n("d784"),r=n("825a"),o=n("1d80"),a=n("129f"),i=n("577e"),s=n("dc4a"),l=n("14c3");c("search",(function(e,t,n){return[function(t){var n=o(this),c=void 0==t?void 0:s(t,e);return c?c.call(t,n):new RegExp(t)[e](i(n))},function(e){var c=r(this),o=i(e),s=n(t,c,o);if(s.done)return s.value;var u=c.lastIndex;a(u,0)||(c.lastIndex=0);var d=l(c,o);return a(c.lastIndex,u)||(c.lastIndex=u),null===d?-1:d.index}]}))},"90b4":function(e,t,n){"use strict";n("43e5")},a3ac:function(e,t,n){"use strict";n("760b")}}]);
//# sourceMappingURL=chunk-ca7ac25a.ecbf3943.js.map